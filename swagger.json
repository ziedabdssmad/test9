{"swagger":"2.0","info":{"version":"1.0.1","title":"gitTest","contact":{"name":"Team Slots","url":"https://confluence.agilefabric.fr.carrefour.com/display/STR2/01+-+Team+Slots"},"license":{"name":"Carrefour"}},"host":"localhost:4200","basePath":"/runtime/5fc7b475e1b7d766a4c6eff6","tags":[{"name":"Authentication Grizzly","description":"JWT token"},{"name":"slots-resources"}],"schemes":["https","http"],"paths":{"/slots/{slot_id}":{"get":{"tags":["slots-resources"],"summary":"Retrieve a slot details by id","description":"Retrieve the details of the given slot id\n","produces":["application/json"],"parameters":[{"name":"slot_id","in":"path","description":"This is the slot identifier","required":true,"type":"string"},{"name":"x-correlation-id","in":"header","description":"This is the correlation id that can be used to link several API requests together","required":false,"type":"string"}],"responses":{"200":{"description":"OK","headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/slot"}},"400":{"description":"Bad Request, return it the error is about client request\nand not managed by a specific http code\n","examples":{"application/json":[{"code":"BAD_REQUEST","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"500":{"description":"Technical error","examples":{"application/json":[{"code":"TECHNICAL_ERROR","message":"more details message"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"404":{"description":"- unkown service_id\n- unkown slot id\n","examples":{"application/json":[{"code":"SERVICE_NOT_FOUND"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}}}}},"/allroles":{"get":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/allusers":{"get":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/me":{"get":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/signin":{"post":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"in":"body","name":"body","description":"SignIn Model","required":true,"schema":{"$ref":"#/definitions/signIn"}}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}}}},"/updateuser":{"put":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"username","in":"query","required":false,"type":"string"}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/slots/{slot_id}/bookings":{"post":{"tags":["slots-resources"],"summary":"Book a slot for a given booking_reference (basket or order)","description":"Create a booking with the given booking_reference\nand the slot identifier\n","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"authorization","in":"header","description":"IAM or STS bearer token (JWT)","required":true,"type":"string"},{"name":"slot_id","in":"path","description":"This is the slot identifier","required":true,"type":"string"},{"name":"x-correlation-id","in":"header","description":"This is the correlation id that can be used to link several API requests together","required":false,"type":"string"},{"in":"body","name":"body","description":"A service_id and a booking_reference to book the slot\nbooking_reference can be a basket_id or an order_id\n","required":true,"schema":{"$ref":"#/definitions/book_slot_request"}}],"responses":{"201":{"description":"OK","examples":{"application/json":[{"code":"NEW_SLOT_BOOKED","expires":"2020-06-19T15:28:55","slot":{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":10,"maximum_day_capacity":15,"reference_round":"1001A","service_id":"143","id":"2C2B2","status":"OPEN","stock_range":"201602281A","used_capacity":0,"used_day_capacity":10}}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/booking_slot_response"}},"400":{"description":"Bad Request, return it the error is about client request\nand not managed by a specific http code\n","examples":{"application/json":[{"code":"BAD_REQUEST","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"401":{"description":"unauthorized, when JWT token:\n  - is not provided\n  - is not valid\n","examples":{"application/json":[{"code":"UNAUTHORIZED","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"412":{"description":"- The slot is CLOSED\n- Slot is outdated\n- The slot is not yet displayed\n- slot full\n- tour full\n- ppc full\n","examples":{"application/json":[{"code":"SLOT_FULL"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"500":{"description":"Technical error","examples":{"application/json":[{"code":"TECHNICAL_ERROR","message":"more details message"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"403":{"description":"forbidden when for example :\n  - The STS JWT Token don't contains the right roles\n  - The user is not allowed to do this action\n","examples":{"application/json":[{"code":"FORBIDDEN","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"404":{"description":"- unkown service_id\n- unkown slot id\n","examples":{"application/json":[{"code":"SERVICE_NOT_FOUND"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"409":{"description":"Store doesn't match with slot","examples":{"application/json":[{"code":"SLOT_AND_SERVICE_ID_DOES_NOT_MATCH"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}}}},"delete":{"tags":["slots-resources"],"summary":"This endpoint allows to unbook a slot","description":"to unbook you must provide\n  - the booking_reference : the ID provided to book the slot (basket_id or order_id)\n  or\n  - the confirmation_reference : the ID provided to confirm the booking (order_id)\n","produces":["application/json"],"parameters":[{"name":"slot_id","in":"path","description":"This is the slot identifier","required":true,"type":"string"},{"name":"x-correlation-id","in":"header","description":"This is the correlation id that can be used to link several API requests together","required":false,"type":"string"},{"name":"service_id","in":"query","description":"The service identifier of the store to which the slot belongs (this is the meti service ID)","required":true,"type":"string"},{"name":"booking_reference","in":"query","description":"This is the ID provided to book a slot","required":false,"type":"string"},{"name":"confirmation_reference","in":"query","description":"This is the ID provided to confirm a booked slot","required":false,"type":"string"}],"responses":{"201":{"description":"Created","examples":{"application/json":[{"code":"SLOT_UNBOOKED","slot":{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":10,"maximum_day_capacity":15,"reference_round":"1001A","service_id":"143","id":"2C2B2","status":"OPEN","stock_range":"201602281A","used_capacity":0,"used_day_capacity":10}}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/slot_action_response"}},"400":{"description":"Bad Request, return it the error is about client request\nand not managed by a specific http code\n","examples":{"application/json":[{"code":"BAD_REQUEST","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"401":{"description":"unauthorized, when JWT token:\n  - is not provided\n  - is not valid\n","examples":{"application/json":[{"code":"UNAUTHORIZED","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"500":{"description":"Technical error","examples":{"application/json":[{"code":"TECHNICAL_ERROR","message":"more details message"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"403":{"description":"forbidden when for example :\n  - The STS JWT Token don't contains the right roles\n  - The user is not allowed to do this action\n","examples":{"application/json":[{"code":"FORBIDDEN","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"404":{"description":"- unkown service_id\n- unkown slot id\n","examples":{"application/json":[{"code":"SERVICE_NOT_FOUND"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}}}}},"/slots/{slot_id}/bookings/{booking_reference}":{"put":{"tags":["slots-resources"],"summary":"confirm a slot booking","description":"This endpoint allows to confirm a slot booking for the given booking reference and a confirmation reference\n","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"authorization","in":"header","description":"IAM or STS bearer token (JWT)","required":true,"type":"string"},{"name":"slot_id","in":"path","description":"This is the slot identifier","required":true,"type":"string"},{"name":"booking_reference","in":"path","description":"this is the basket_id or order_id provided to book the slot","required":true,"type":"string"},{"name":"x-correlation-id","in":"header","description":"This is the correlation id that can be used to link several API requests together","required":false,"type":"string"},{"in":"body","name":"body","description":"A service_id and a confirmation_reference to confirm booked slot\nconfirmation_reference should be order_id\n","required":true,"schema":{"$ref":"#/definitions/confirm_slot_request"}}],"responses":{"201":{"description":"Created","examples":{"application/json":[{"code":"SLOT_CONFIRMED","slot":{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":10,"maximum_day_capacity":15,"reference_round":"1001A","service_id":"143","id":"2C2B2","status":"OPEN","stock_range":"201602281A","used_capacity":0,"used_day_capacity":10}}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/slot_action_response"}},"400":{"description":"Bad Request, return it the error is about client request\nand not managed by a specific http code\n","examples":{"application/json":[{"code":"BAD_REQUEST","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"401":{"description":"unauthorized, when JWT token:\n  - is not provided\n  - is not valid\n","examples":{"application/json":[{"code":"UNAUTHORIZED","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"412":{"description":"- The slot is CLOSED\n- Slot is outdated\n- The slot is not yet displayed\n- slot full\n- tour full\n- ppc full\n","examples":{"application/json":[{"code":"SLOT_FULL"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"500":{"description":"Technical error","examples":{"application/json":[{"code":"TECHNICAL_ERROR","message":"more details message"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"403":{"description":"forbidden when for example :\n  - The STS JWT Token don't contains the right roles\n  - The user is not allowed to do this action\n","examples":{"application/json":[{"code":"FORBIDDEN","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"404":{"description":"- unkown service_id\n- unkown slot id\n","examples":{"application/json":[{"code":"SERVICE_NOT_FOUND"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"409":{"description":"Store doesn't match with slot","examples":{"application/json":[{"code":"SLOT_AND_SERVICE_ID_DOES_NOT_MATCH"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}}}}},"/grant":{"put":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"username","in":"query","required":false,"type":"string"}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/deleteuser":{"delete":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"username","in":"query","required":false,"type":"string"}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}},"/signup":{"post":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"in":"body","name":"body","required":true}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}}}},"/slots":{"get":{"tags":["slots-resources"],"summary":"Retrieve the list of slots of one or several stores","description":"Retrieve the list of slots of one or several stores\nbetween the start date and the end date\nhaving the given statuts or all slots regardless of the status if no status is selected\n","produces":["application/json"],"parameters":[{"name":"service_id","in":"query","description":"The service identifier of the store to which the slot belongs (this is the meti service ID)","required":true,"type":"string"},{"name":"start_datetime","in":"query","description":"This is the beginning of the time range to return slots\nif start_datetime is not provided default value will be today at 00:00:00\nend_datetime must be present if start_datetime is present\n","required":false,"type":"string"},{"name":"end_datetime","in":"query","description":"This is the end of the time range to return slots\nif end_datetime is not provided default value will be\n- 5 next days for drive\n- 7 next days for LAD.\n\nend_datetime must be present if start_datetime is present.\n\nthe difference between start_datetime and end_datetime should be below than 20 days\notherwise end_datetime will be ignored and the response will be the list of slots\nbetween start_datetime and start_datetime + 20 days\n","required":false,"type":"string"},{"name":"status","in":"query","description":"The status of slots. default return all slots regardless of the status","required":false,"type":"string","enum":["OPEN","CLOSED","FULL"]},{"name":"x-correlation-id","in":"header","description":"This is the correlation id that can be used to link several API requests together","required":false,"type":"string"}],"responses":{"200":{"description":"OK","examples":{"application/json":[[{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":15,"maximum_day_capacity":10,"reference_round":"1001A","service_id":"143","id":"11A11","status":"OPEN","stock_range":"201602281A","used_capacity":0,"used_day_capacity":5},{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":10,"maximum_day_capacity":15,"reference_round":"1001A","service_id":"143","id":"2C2B2","status":"FULL","stock_range":"201602281A","used_capacity":0,"used_day_capacity":10},{"begin_datetime":"2018-09-17T12:59:00","cut_off":"2018-09-17T12:59:00","end_datetime":"2018-09-17T12:59:00","maximum_capacity":15,"maximum_day_capacity":10,"reference_round":"1001A","service_id":"143","id":"3F3BD","status":"CLOSED","stock_range":"201602281A","used_capacity":0,"used_day_capacity":5}]]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"type":"array","items":{"$ref":"#/definitions/slot"}}},"400":{"description":"Bad Request, return it the error is about client request\nand not managed by a specific http code\n","examples":{"application/json":[{"code":"BAD_REQUEST","message":"more details about the error"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"500":{"description":"Technical error","examples":{"application/json":[{"code":"TECHNICAL_ERROR","message":"more details message"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}},"404":{"description":"- unkown service_id\n- unkown slot id\n","examples":{"application/json":[{"code":"SERVICE_NOT_FOUND"}]},"headers":{"X-Correlation-ID":{"type":"string","description":"This is the correlation id that can be used to link several API requests together"}},"schema":{"$ref":"#/definitions/error_response"}}}}},"/activate":{"post":{"tags":["Authentication Grizzly"],"consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"username","in":"query","required":false,"type":"string"}],"responses":{"200":{"description":"Ok"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"}},"security":[{"api_key":[]}]}}},"securityDefinitions":{"api_key":{"description":"Standard Authorization header using the Bearer scheme. \n\n Value example: \"Bearer {token}\"","type":"apiKey","name":"Authorization","in":"header"}},"definitions":{"confirm_slot_request":{"required":["confirmation_reference","service_id"],"properties":{"confirmation_reference":{"type":"string","example":"A00000","description":"An ID that can be used after to unbook the slot if needed. Usually this is the order_id\n"},"service_id":{"type":"string","example":335,"description":"The service identifier of the store to which the slot belongs (this is the meti service ID)"}},"title":"confirm_slot_request","description":"The request object needed to confirm a slot\n"},"base_slot_response":{"type":"object","properties":{"code":{"$ref":"#/definitions/response_code"},"message":{"type":"string","example":"the slot (1234) is CLOSED","description":"response message, when we need more details than the code."}},"title":"base_slot_response","description":"a base response format containing code and message"},"booking_slot_response":{"title":"booking_slot_response","description":"the response of successful bocking request"},"response_code":{"type":"string","title":"response_code","description":"A list of possible response code used to success or error","enum":["NEW_SLOT_BOOKED","SLOT_ALREADY_BOOKED","SLOT_UPDATED","SLOT_NOT_FOUND","CONFIRMED_BOOKING_ALREADY_EXIST","BOOKING_NOT_FOUND","BOOKING_REPLACED","SLOT_AND_METICODE_DOES_NOT_MATCH","SLOT_CLOSED","SLOT_NOT_DISPLAYED","SLOT_IN_PAST","SLOT_FULL","DAY_FULL","TOUR_FULL","PPC_FULL","SLOT_OUTDATED","TOUR_OUTDATED","SLOT_UNBOOKED","SLOT_CONFIRMED","BOOKING_AND_SLOT_DOES_NOT_MATCH","UNAUTHORIZED","TOO_MANY_SERVICE_ID","INVALID_DATE_TIME_RANGE","BAD_REQUEST","TECHNICAL_ERROR","FORBIDDEN"]},"error_response":{"title":"error_response"},"signIn":{"properties":{"username":{"type":"string"},"password":{"type":"string"}},"title":"signIn"},"book_slot_request":{"type":"object","required":["booking_reference","service_id"],"properties":{"booking_reference":{"type":"string","example":1324,"description":"this is the basket_id or order_id used to book or confirm the slot"},"service_id":{"type":"string","example":335,"description":"The service identifier of the store to which the slot belongs (this is the meti service ID)"}},"title":"book_slot_request","description":"The request object needed to book a slot\n"},"slot_status":{"type":"string","title":"slot_status","description":"The list of possible slot status\n- OPEN : when booking is possible\n- CLOSED : when slot is CLOSED by shop, although the max capacity is not reached\n- FULL :  when the day capacity or the slot capacity is reached\nWhen slot has the CLOSED or FULL status booking is no longer available\n","enum":["OPEN","CLOSED","FULL"]},"slot":{"type":"object","properties":{"begin_datetime":{"type":"string","example":"2020-09-01T13:00:00+02:00","description":"This is the slot beginning date and time"},"cut_off":{"type":"string","example":"2020-09-01T11:00:00+02:00","description":"Date and time before the slot become unavailable"},"end_datetime":{"type":"string","example":"2020-09-01T13:30:00+02:00","description":"This is the slot ending date and time"},"maximum_capacity":{"type":"integer","example":15,"description":"This is the maximum slot capacity (number of baskets/orders)"},"maximum_day_capacity":{"type":"integer","example":10,"description":"It's the maximum capacity of the day defined by the shop\n"},"reference_round":{"type":"string","example":"1001A","description":"Day ref (1 for monday, 2 for tuesday, 3, 4, 5, 6, 7) + round ref (001, 002, 003, nn) + Week type (A, B, C, x).\n! will be available into V2 version\n"},"service_id":{"type":"string","example":143,"description":"The service identifier of the store to which the slot belongs"},"id":{"type":"string","example":265547,"description":"This is the identifier of the slot"},"status":{"$ref":"#/definitions/slot_status"},"stock_range":{"type":"string","example":"201602281A","description":"concatenation between the day of preparation and 1A, 1B, 2A, 2B, 3A, 3B, 4A, 4B, 5A, 5B ...\n! will be available into V2 version\n"},"used_capacity":{"type":"integer","example":0,"description":"This is the number of baskets/orders already affected to this slot"},"used_day_capacity":{"type":"integer","example":5,"description":"Total number of baskets/orders on all the slots of the day"}},"title":"slot","description":"A slot details object\n"},"signUp":{"properties":{"username":{"type":"string"},"password":{"type":"string"},"firstname":{"type":"string"},"lastname":{"type":"string"},"email":{"type":"string"},"phone":{"type":"number"}},"title":"signUp"},"slot_action_response":{"title":"slot_action_response"}}}